<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flappy Photo Game</title>

<style>
body{
margin:0;
overflow:hidden;
background:black;
}
canvas{
display:block;
}
</style>
</head>

<body>

<canvas id="gameCanvas"></canvas>
<audio id="bgm" src="music.mp3" loop></audio>

<script>

let canvas=document.getElementById("gameCanvas");
let ctx=canvas.getContext("2d");

canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

let bird=new Image();
bird.src="img1.png";

let pipeImg=new Image();
pipeImg.src="image2.png";

let bgImg=new Image();
bgImg.src="bg.png";

let bgm=document.getElementById("bgm");

let x=60;
let y;
let velocity=0;
let gravity=0.4;
let lift=-6;

let pipes=[];
let score=0;
let gameOver=false;

let gap=320;
let frameCount=0;

function resetGame(){
y=canvas.height/2;
velocity=0;
pipes=[];
score=0;
gameOver=false;
frameCount=0;

pipes.push({
x:canvas.width,
top:200,
bottom:200+gap
});
}

document.onclick=()=>{
if(gameOver){
resetGame();
update();
}else{
velocity=lift;
bgm.play();
}
};

function drawBird(){
ctx.save();
let angle=velocity*0.05;
ctx.translate(x+30,y+30);
ctx.rotate(angle);
ctx.drawImage(bird,-30,-30,60,60);
ctx.restore();
}

function drawPipe(pipe){

ctx.drawImage(pipeImg,pipe.x,0,50,pipe.top);

ctx.save();
ctx.translate(pipe.x+25,pipe.bottom);
ctx.scale(1,-1);
ctx.drawImage(pipeImg,-25,0,50,canvas.height-pipe.bottom);
ctx.restore();

}

function update(){

ctx.drawImage(bgImg,0,0,canvas.width,canvas.height);

velocity+=gravity;
y+=velocity;

drawBird();

frameCount++;

if(frameCount % 120 == 0){

let top=Math.random()*(canvas.height-gap-150)+75;

pipes.push({
x:canvas.width,
top:top,
bottom:top+gap
});

}

for(let i=0;i<pipes.length;i++){

pipes[i].x-=1;

drawPipe(pipes[i]);

let hitboxW=40;
let hitboxH=40;
let offsetX=10;
let offsetY=10;

if(
x+offsetX+hitboxW > pipes[i].x &&
x+offsetX < pipes[i].x + 50 &&
(
y+offsetY < pipes[i].top ||
y+offsetY+hitboxH > pipes[i].bottom
)
){
gameOver=true;
}

if(pipes[i].x==60){
score++;
}
}

ctx.fillStyle="white";
ctx.font="25px Arial";
ctx.fillText("Score: "+score,20,40);

if(y>canvas.height || y<0){
gameOver=true;
}

if(!gameOver){
requestAnimationFrame(update);
}else{
ctx.fillText("Game Over",canvas.width/2-60,canvas.height/2);
ctx.fillText("Tap to Restart",canvas.width/2-70,canvas.height/2+40);
}
}

resetGame();
update();

</script>

</body>
</html>
